//! å®šä¹‰ã€Œè¯æ³•Narseseã€çš„æ ¼å¼
//! * ğŸ“ŒWHYï¼šåŸå…ˆã€Œæšä¸¾Narseseã€ä¸­çš„ã€ŒNarseseæ ¼å¼ã€æå‰å®šä¹‰äº†æ‰€æœ‰ã€ŒNarseseè¯é¡¹ç±»å‹ã€çš„èŒƒå›´
//!   * ğŸ¯å¸Œæœ›èƒ½æ‰©å®½ã€ŒåŸå­è¯é¡¹ã€ã€Œå¤åˆè¯é¡¹ã€ã€Œé™ˆè¿°ã€çš„ç±»å‹
//! * ğŸ¯æä¾›CommonNarseseä¸­æ‰€æœ‰çš„è¯æ³•ä¿¡æ¯
//!   * âš ï¸ä»…ä½œä¸ºã€Œä¿¡æ¯ã€ä½¿ç”¨ï¼Œä¸æä¾›ä»»ä½• è§£ææ—¶/æ ¼å¼åŒ–æ—¶ ä¼˜åŒ–
//! * ğŸš©ç›®å‰å¯¹æ­¤å¤„çš„ã€Œæ ¼å¼ã€ä¸è¿›è¡Œé‡å‘½åå¤„ç†
//!   * ğŸ“Œç†ç”±ï¼šå¯ä»¥ç”¨ã€Œè·¯å¾„é™å®šã€ã€Œuse * asã€ç»•å¼€ã€Œé‡åé—®é¢˜ã€
//! * ğŸš©æ­¤å¤„ä¸å†å¼€æ”¾ã€Œå†…å®¹`Content`ã€ç±»å‹
//!   * ğŸ“Œã€Œè¯æ³•Narseseã€æ•°æ®ç»“æ„ä¸­å·²å›ºå®šç±»å‹ä¸º[`&'a str`]/&[`str`]
//!   * å› æ­¤æ•´ä¸ªã€Œè¯æ³•Narseseæ ¼å¼ã€å·²ç»å’Œå­—ç¬¦ä¸²ç»‘å®šäº†

use util::{PrefixMatchDict, PrefixMatchDictPair};

/// Narseseæ ¼å¼/ç©ºç™½ç¬¦
pub struct NarseseFormatSpace<'a> {
    /// ç”¨äºåˆ¤æ–­å­—ç¬¦æ˜¯å¦ä¸ºç©ºç™½ç¬¦ï¼ˆè§£æç”¨ï¼‰
    pub parse: Box<dyn Fn(char) -> bool>,
    /// ç©ºç™½ç¬¦ï¼ˆæ ¼å¼åŒ–/åˆ†éš”è¯é¡¹ï¼‰
    /// * ğŸ¯å¤åˆè¯é¡¹/é™ˆè¿°
    pub format_terms: &'a str,
    /// ç©ºç™½ç¬¦ï¼ˆæ ¼å¼åŒ–/åˆ†éš”æ¡ç›®ï¼‰
    /// * ğŸ¯ã€Œé¢„ç®— è¯é¡¹æ ‡ç‚¹ æ—¶é—´æˆ³ çœŸå€¼ã€
    pub format_items: &'a str,
}

/// åŸå­è¯é¡¹æ ¼å¼
/// * ğŸ“Œæ ¼å¼ï¼š[å‰ç¼€] + (æ ‡è¯†ç¬¦)
pub struct NarseseFormatAtom {
    /// åˆæ³•çš„ã€ŒåŸå­è¯é¡¹å‰ç¼€ã€
    /// * è¯è¯­
    /// * ç‹¬ç«‹å˜é‡
    /// * éç‹¬å˜é‡
    /// * æŸ¥è¯¢å˜é‡
    /// * é—´éš”
    /// * æ“ä½œç¬¦
    pub prefixes: PrefixMatchDict,
    /// ç”¨äºåˆ¤æ–­å­—ç¬¦æ˜¯å¦ä¸ºã€Œåˆæ³•åŸå­æ ‡è¯†ç¬¦ã€çš„å‡½æ•°
    pub is_identifier: Box<dyn Fn(char) -> bool>,
}

/// å¤åˆè¯é¡¹æ ¼å¼
#[derive(Debug, Clone)]
pub struct NarseseFormatCompound<'a> {
    /// åˆæ³•çš„ã€Œé›†åˆå¤åˆè¯é¡¹æ‹¬å¼§å¯¹ã€
    /// * å¤–å»¶é›†
    /// * å†…æ¶µé›†
    pub set_brackets: PrefixMatchDictPair<&'a str>,

    /// é€šç”¨çš„ã€Œå¤åˆè¯é¡¹æ‹¬å¼§å¯¹ã€
    pub brackets: (&'a str, &'a str),

    /// å¤åˆè¯é¡¹å…ƒç´ åˆ†éš”ç¬¦
    pub separator: &'a str,

    /// åˆæ³•çš„ã€Œå¤åˆè¯é¡¹è¿æ¥ç¬¦ã€
    /// * å¤–å»¶äº¤/å†…æ¶µäº¤
    /// * å¤–å»¶å·®/å†…æ¶µå·®
    /// * ä¹˜ç§¯
    /// * å¤–å»¶åƒ/å†…æ¶µåƒ
    /// * åˆå–/æå–
    /// * å¦å®š
    /// * é¡ºåºåˆå–/å¹³è¡Œåˆå–
    pub connecters: PrefixMatchDict,
}

/// é™ˆè¿°æ ¼å¼
#[derive(Debug, Clone)]
pub struct NarseseFormatStatement<'a> {
    /// é€šç”¨çš„ã€Œé™ˆè¿°æ‹¬å¼§å¯¹ã€
    pub brackets: (&'a str, &'a str),

    /// åˆæ³•çš„ã€Œä¸­ç¼€ç³»è¯ã€
    /// * ç»§æ‰¿
    /// * ç›¸ä¼¼
    /// * è•´å«
    /// * ç­‰ä»·
    /// * å®ä¾‹/å±æ€§/å®ä¾‹å±æ€§
    /// * é¢„æµ‹æ€§/å¹¶å‘æ€§/å›é¡¾æ€§ è•´å«
    /// * é¢„æµ‹æ€§/å¹¶å‘æ€§/å›é¡¾æ€§ ç­‰ä»·
    pub copulas: PrefixMatchDict,
}

/// è¯­å¥æ ¼å¼ï¼ˆå«æ ‡ç‚¹ã€çœŸå€¼ã€æ—¶é—´æˆ³ï¼‰
#[derive(Debug, Clone)]
pub struct NarseseFormatSentence<'a> {
    /// åˆæ³•çš„ã€Œæ ‡ç‚¹ã€
    pub punctuations: PrefixMatchDict,

    /// çœŸå€¼æ‹¬å¼§
    /// * ğŸš©ä»…é€šè¿‡æ‹¬å¼§æ•è·æ•´ä¸ªã€ŒçœŸå€¼ã€å­—ç¬¦ä¸²ï¼Œè€Œ**ä¸å†ç»†åˆ†å†…éƒ¨ç»“æ„**
    pub truth_brackets: (&'a str, &'a str),

    /// æ—¶é—´æˆ³æ‹¬å¼§
    /// * ğŸš©ä»…é€šè¿‡æ‹¬å¼§æ•è·æ•´ä¸ªã€Œæ—¶é—´æˆ³ã€å­—ç¬¦ä¸²ï¼Œè€Œ**ä¸å†ç»†åˆ†å†…éƒ¨ç»“æ„**
    pub stamp_brackets: (&'a str, &'a str),
}

/// ä»»åŠ¡æ ¼å¼ï¼ˆå«é¢„ç®—å€¼ï¼‰
#[derive(Debug, Clone)]
pub struct NarseseFormatTask<'a> {
    /// é¢„ç®—å€¼æ‹¬å¼§
    /// * ğŸš©ä»…é€šè¿‡æ‹¬å¼§æ•è·æ•´ä¸ªã€Œé¢„ç®—å€¼ã€å­—ç¬¦ä¸²ï¼Œè€Œ**ä¸å†ç»†åˆ†å†…éƒ¨ç»“æ„**
    pub budget_brackets: (&'a str, &'a str),
}

/// æ€»ã€Œè¯æ³•Narseseæ ¼å¼ã€
/// * âš™ï¸åŒ…æ‹¬ï¼š
///   * åŸå­è¯é¡¹æ ¼å¼
///   * å¤åˆè¯é¡¹æ ¼å¼
///   * é™ˆè¿°æ ¼å¼
///   * è¯­å¥æ ¼å¼ï¼ˆå«æ ‡ç‚¹ã€çœŸå€¼ã€æ—¶é—´æˆ³ï¼‰
///   * ä»»åŠ¡æ ¼å¼ï¼ˆå«é¢„ç®—å€¼ï¼‰
/// * ğŸš©ä¸ç‰¹åŒ–ç¬¦å·ä¸º`LexicalNarseseFormat`
///   * ğŸ“Œè¿™ç§ã€Œç¬¦å·ç‰¹åŒ–ã€äº¤ç»™è°ƒç”¨æ–¹å¤„ç†
pub struct NarseseFormat<'a> {
    /// ç©ºç™½ç¬¦æ ¼å¼
    pub space: NarseseFormatSpace<'a>,

    /// åŸå­è¯é¡¹æ ¼å¼
    pub atom: NarseseFormatAtom,

    /// å¤åˆè¯é¡¹æ ¼å¼
    pub compound: NarseseFormatCompound<'a>,

    /// é™ˆè¿°æ ¼å¼
    pub statement: NarseseFormatStatement<'a>,

    /// è¯­å¥æ ¼å¼ï¼ˆå«æ ‡ç‚¹ã€çœŸå€¼ã€æ—¶é—´æˆ³ï¼‰
    pub sentence: NarseseFormatSentence<'a>,

    /// ä»»åŠ¡æ ¼å¼ï¼ˆå«é¢„ç®—å€¼ï¼‰
    pub task: NarseseFormatTask<'a>,
    // ! ç›¸æ¯”ã€Œæšä¸¾Narseseã€ä¸å†æœ‰ã€Œå…³é”®è¯æˆªæ–­é€‰é¡¹ã€
    // ! ğŸš©ã€2024-03-15 17:48:03ã€‘ç›®å‰`enable_keyword_truncation`å¼ºåˆ¶ä¸º`true`
}
